---
title: "Plate Iteration"
author: "Jordan Lo"
date: "2022-12-16"
output: html_document
---
------------------------------------------------------PACKAGE LOADING------------------------------------------------
```{r}
# tidyverse allows us to do our data processing
library("tidyverse")
# readxl allows us to read excel files
library("readxl")
# writexl allows us to write to excel files
library("writexl")
# tidyr lets us reshape our long data into wide data
library("tidyr")
# qpcR lets us merge data frames side by side
library("qpcR")
```


------------------------------------------------------FUNCTION CALLS--------------------------------------------------
```{r}
# reads the raw data excel file and stores it as a variable
# FOR NEW USERS:
#     CHANGE THE PATH IN THE read_excel FUNCTION TO THE RAW DATA EXCEL
raw <- read_excel("CITRC\\raw_data\\All_Ang1Ang2_Data_Set1-11.xlsx", 
                       sheet = "RawData")

# reads in the automation script as a callable function
source("./automation.R")

# splits the raw data into separate plate based data frames
split_plates <- split(raw ,
                      raw$`Plate Name`)

# applies the automation function to the various split plates
plate_dataframes <- lapply(split_plates, automation)

# writes multiple excel files using the list of data frames above
lapply(names(plate_dataframes),
       function(x) write_xlsx(plate_dataframes[[x]], 
                              # CHANGE THIS TO THE ASSAYS RUN
                              path = paste(x, "Ang1Ang2_PD.xlsx",
                                           sep = "_")))
```