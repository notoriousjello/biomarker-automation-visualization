# Enables us to write to an excel file
library("writexl")
# GGally alows us to use their pairs funtion
library("GGally")
# ggplot2 lets us make pretty graphs
library("ggplot2")
# ggpubr
library("ggpubr")
bio_clinical <- read_excel("C:\\Users\\notjello\\Documents\\Github\\Biomarker-Master-Sheet\\Biomarker_Assays_and_Clinical_Data_20221122.xlsx")
# creates new columns for the log transformations of the biomarker concentrations
bio_clinical$log_ang2 <- log(bio_clinical$`urine_ang-2_V1 (pg/mL)`)
bio_clinical$log_il18 <- log(bio_clinical$`urine_il18_V1 (pg/mL)`)
bio_clinical$log_ngal <- log(bio_clinical$`urine_ngal_V1 (pg/mL)`)
bio_clinical$log_sfas <- log(bio_clinical$`urine_sfas_V1 (pg/mL)`)
# converts covid19 diagnosis to 0 for neg and 1 for pos
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'Pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'neg'] <- "0"
bio_clinical$COVID19<- as.numeric(as.character(bio_clinical$COVID19))
# converts aki_hosp from numeric into a character for better visualization
bio_clinical$aki_hosp <- as.character(bio_clinical$aki_hosp)
bio_clinical$aki_hosp <- as.character(bio_clinical$prevalent_aki)
# view(bio_clinical)
# creates a pairs plot of the biomarker concentration data using ggpairs
bio_clinical %>%
select(c(`log_ang2`, `log_il18`, `log_ngal`, `log_sfas`, )) %>%  # selects the data used
ggpairs(labels = letters[1:ncol(bio_clinical)],                  # creates the actual plot
lower = list(continuous=wrap("smooth"))) +
theme_bw() +                                                     # color scheme of plot
ggtitle("Correlation Data of Biomarker Concentrations") +        # creates a title
theme(plot.title = element_text(hjust = 0.5))                    # centers titel
bio_clinical_NA <- bio_clinical %>%
filter(aki_hosp != "NA")
# creates a jitter plot of the ang 2 levels and the presence of incident aki
ang2_jitter <-
ggplot(data = bio_clinical_NA,                          # selects dataframe
mapping = (aes(x = log_ang2, y = aki_hosp))) +   # maps variables to x and y
geom_jitter(width = 0,                                  # sets parameters for the jitter
height = 0.2) +
labs(x = "[Ang-2]",                                     # labels axes
y = " ")
il18_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_il18, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[IL-18]",
y = " ")
sfas_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_sfas, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[sFas]",
y = " ")
ngal_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_ngal, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[NGAL]",
y = " ")
# creates a 2x2 matrix of the four plots
figure <- ggarrange(ang2_jitter, il18_jitter, ngal_jitter, sfas_jitter,
ncol = 2,
nrow = 2)
# annotates the figure with a title and description
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = aki_hosp)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box, il18_box, ngal_box, sfas_box,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = prevalent_aki)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = prevalent_aki)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = prevalent_aki)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = prevalent_aki)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box_prevalent, il18_box_prevalent, ngal_box_prevalent, sfas_box_prevalent,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Prevalent AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are logn transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = aki_hosp)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box, il18_box, ngal_box, sfas_box,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
# Enables us to read excel files
library("readxl")
# Allows us to do data processing and clean-up
library("tidyverse")
# Enables us to write to an excel file
library("writexl")
# GGally alows us to use their pairs funtion
library("GGally")
# ggplot2 lets us make pretty graphs
library("ggplot2")
# ggpubr
library("ggpubr")
bio_clinical <- read_excel("C:\\Users\\notjello\\Documents\\Github\\Biomarker-Master-Sheet\\Biomarker_Assays_and_Clinical_Data_20221122.xlsx")
# creates new columns for the log transformations of the biomarker concentrations
bio_clinical$log_ang2 <- log(bio_clinical$`urine_ang-2_V1 (pg/mL)`)
bio_clinical$log_il18 <- log(bio_clinical$`urine_il18_V1 (pg/mL)`)
bio_clinical$log_ngal <- log(bio_clinical$`urine_ngal_V1 (pg/mL)`)
bio_clinical$log_sfas <- log(bio_clinical$`urine_sfas_V1 (pg/mL)`)
# converts covid19 diagnosis to 0 for neg and 1 for pos
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'Pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'neg'] <- "0"
bio_clinical$COVID19<- as.numeric(as.character(bio_clinical$COVID19))
# converts aki_hosp from numeric into a character for better visualization
bio_clinical$aki_hosp <- as.character(bio_clinical$aki_hosp)
bio_clinical$aki_hosp <- as.character(bio_clinical$prevalent_aki)
# view(bio_clinical)
# creates a pairs plot of the biomarker concentration data using ggpairs
bio_clinical %>%
select(c(`log_ang2`, `log_il18`, `log_ngal`, `log_sfas`, )) %>%  # selects the data used
ggpairs(labels = letters[1:ncol(bio_clinical)],                  # creates the actual plot
lower = list(continuous=wrap("smooth"))) +
theme_bw() +                                                     # color scheme of plot
ggtitle("Correlation Data of Biomarker Concentrations") +        # creates a title
theme(plot.title = element_text(hjust = 0.5))                    # centers titel
bio_clinical_NA <- bio_clinical %>%
filter(aki_hosp != "NA")
# creates a jitter plot of the ang 2 levels and the presence of incident aki
ang2_jitter <-
ggplot(data = bio_clinical_NA,                          # selects dataframe
mapping = (aes(x = log_ang2, y = aki_hosp))) +   # maps variables to x and y
geom_jitter(width = 0,                                  # sets parameters for the jitter
height = 0.2) +
labs(x = "[Ang-2]",                                     # labels axes
y = " ")
il18_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_il18, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[IL-18]",
y = " ")
sfas_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_sfas, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[sFas]",
y = " ")
ngal_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_ngal, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[NGAL]",
y = " ")
# creates a 2x2 matrix of the four plots
figure <- ggarrange(ang2_jitter, il18_jitter, ngal_jitter, sfas_jitter,
ncol = 2,
nrow = 2)
# annotates the figure with a title and description
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = aki_hosp)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box, il18_box, ngal_box, sfas_box,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = prevalent_aki)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = prevalent_aki)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = prevalent_aki)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box_prevalent <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = prevalent_aki)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box_prevalent, il18_box_prevalent, ngal_box_prevalent, sfas_box_prevalent,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Prevalent AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are logn transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
# Enables us to read excel files
library("readxl")
# Allows us to do data processing and clean-up
library("tidyverse")
# Enables us to write to an excel file
library("writexl")
# GGally alows us to use their pairs funtion
library("GGally")
# ggplot2 lets us make pretty graphs
library("ggplot2")
# ggpubr
library("ggpubr")
bio_clinical <- read_excel("C:\\Users\\notjello\\Documents\\Github\\Biomarker-Master-Sheet\\Biomarker_Assays_and_Clinical_Data_20221122.xlsx")
# creates new columns for the log transformations of the biomarker concentrations
bio_clinical$log_ang2 <- log(bio_clinical$`urine_ang-2_V1 (pg/mL)`)
bio_clinical$log_il18 <- log(bio_clinical$`urine_il18_V1 (pg/mL)`)
bio_clinical$log_ngal <- log(bio_clinical$`urine_ngal_V1 (pg/mL)`)
bio_clinical$log_sfas <- log(bio_clinical$`urine_sfas_V1 (pg/mL)`)
# converts covid19 diagnosis to 0 for neg and 1 for pos
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'Pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'neg'] <- "0"
bio_clinical$COVID19<- as.numeric(as.character(bio_clinical$COVID19))
# converts aki_hosp from numeric into a character for better visualization
bio_clinical$aki_hosp <- as.character(bio_clinical$aki_hosp)
bio_clinical$aki_hosp <- as.character(bio_clinical$prevalent_aki)
# view(bio_clinical)
# creates a pairs plot of the biomarker concentration data using ggpairs
bio_clinical %>%
select(c(`log_ang2`, `log_il18`, `log_ngal`, `log_sfas`, )) %>%  # selects the data used
ggpairs(labels = letters[1:ncol(bio_clinical)],                  # creates the actual plot
lower = list(continuous=wrap("smooth"))) +
theme_bw() +                                                     # color scheme of plot
ggtitle("Correlation Data of Biomarker Concentrations") +        # creates a title
theme(plot.title = element_text(hjust = 0.5))                    # centers titel
bio_clinical_NA <- bio_clinical %>%
filter(aki_hosp != "NA")
# creates a jitter plot of the ang 2 levels and the presence of incident aki
ang2_jitter <-
ggplot(data = bio_clinical_NA,                          # selects dataframe
mapping = (aes(x = log_ang2, y = aki_hosp))) +   # maps variables to x and y
geom_jitter(width = 0,                                  # sets parameters for the jitter
height = 0.2) +
labs(x = "[Ang-2]",                                     # labels axes
y = " ")
il18_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_il18, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[IL-18]",
y = " ")
sfas_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_sfas, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[sFas]",
y = " ")
ngal_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_ngal, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[NGAL]",
y = " ")
# creates a 2x2 matrix of the four plots
figure <- ggarrange(ang2_jitter, il18_jitter, ngal_jitter, sfas_jitter,
ncol = 2,
nrow = 2)
# annotates the figure with a title and description
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = aki_hosp)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box, il18_box, ngal_box, sfas_box,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
# Enables us to read excel files
library("readxl")
# Allows us to do data processing and clean-up
library("tidyverse")
# Enables us to write to an excel file
library("writexl")
# GGally alows us to use their pairs funtion
library("GGally")
# ggplot2 lets us make pretty graphs
library("ggplot2")
# ggpubr
library("ggpubr")
bio_clinical <- read_excel("C:\\Users\\notjello\\Documents\\Github\\Biomarker-Master-Sheet\\Biomarker_Assays_and_Clinical_Data_20221122.xlsx")
# creates new columns for the log transformations of the biomarker concentrations
bio_clinical$log_ang2 <- log(bio_clinical$`urine_ang-2_V1 (pg/mL)`)
bio_clinical$log_il18 <- log(bio_clinical$`urine_il18_V1 (pg/mL)`)
bio_clinical$log_ngal <- log(bio_clinical$`urine_ngal_V1 (pg/mL)`)
bio_clinical$log_sfas <- log(bio_clinical$`urine_sfas_V1 (pg/mL)`)
# converts covid19 diagnosis to 0 for neg and 1 for pos
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'Pos'] <- "1"
bio_clinical['COVID19'][bio_clinical['COVID19'] == 'neg'] <- "0"
bio_clinical$COVID19<- as.numeric(as.character(bio_clinical$COVID19))
# converts aki_hosp from numeric into a character for better visualization
bio_clinical$aki_hosp <- as.character(bio_clinical$aki_hosp)
bio_clinical$aki_hosp <- as.character(bio_clinical$prevalent_aki)
# view(bio_clinical)
# creates a pairs plot of the biomarker concentration data using ggpairs
bio_clinical %>%
select(c(`log_ang2`, `log_il18`, `log_ngal`, `log_sfas`, )) %>%  # selects the data used
ggpairs(labels = letters[1:ncol(bio_clinical)],                  # creates the actual plot
lower = list(continuous=wrap("smooth"))) +
theme_bw() +                                                     # color scheme of plot
ggtitle("Correlation Data of Biomarker Concentrations") +        # creates a title
theme(plot.title = element_text(hjust = 0.5))                    # centers titel
bio_clinical_NA <- bio_clinical %>%
filter(aki_hosp != "NA")
# creates a jitter plot of the ang 2 levels and the presence of incident aki
ang2_jitter <-
ggplot(data = bio_clinical_NA,                          # selects dataframe
mapping = (aes(x = log_ang2, y = aki_hosp))) +   # maps variables to x and y
geom_jitter(width = 0,                                  # sets parameters for the jitter
height = 0.2) +
labs(x = "[Ang-2]",                                     # labels axes
y = " ")
il18_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_il18, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[IL-18]",
y = " ")
sfas_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_sfas, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[sFas]",
y = " ")
ngal_jitter <-
ggplot(data = bio_clinical_NA,
mapping = (aes(x = log_ngal, y = aki_hosp))) +
geom_jitter(width = 0,
height = 0.2) +
labs(x = "[NGAL]",
y = " ")
# creates a 2x2 matrix of the four plots
figure <- ggarrange(ang2_jitter, il18_jitter, ngal_jitter, sfas_jitter,
ncol = 2,
nrow = 2)
# annotates the figure with a title and description
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
ang2_box <- ggplot(data = bio_clinical_NA, aes(x = log_ang2, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[Ang-2]",
y = " ")
il18_box <- ggplot(data = bio_clinical_NA, aes(x = log_il18, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[IL-18]",
y = " ")
sfas_box <- ggplot(data = bio_clinical_NA, aes(x = log_sfas, y = aki_hosp)) +
geom_boxplot() +
labs(x = "[sFas]",
y = " ")
ngal_box <- ggplot(data = bio_clinical_NA, aes(x = log_ngal, y = aki_hosp)) +
geom_boxplot()+
labs(x = "[NGAL]",
y = " ")
figure <- ggarrange(ang2_box, il18_box, ngal_box, sfas_box,
ncol = 2,
nrow = 2)
annotate_figure(figure,
top = text_grob("Biomarker Concentrations and Rates of Incident AKI
in CHROME Participants",
size = 12,
face = "bold"),
bottom = text_grob("Concentrations are log transformed and taken from the first visit
0 = No AKI | 1 = AKI",
size = 10,
face = "bold"))
